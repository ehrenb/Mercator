{% extends "layout.html" %}
{% block head %}
  {{ super() }}
{% endblock %}
{% block content %}
  <h1> Progress </h1>
  <p>

<script>
var interval = setInterval(update_progress, 1000);
function update_progress() {
     $.get('/analysis_progress').done(function(n, out_file){
         //n = n / 5;  // percent value
         console.log(n);
         if (n == 100) {
            console.log('here');
            clearInterval(interval);
            //callback(); // user defined
            document.getElementById("results").disabled = false;
            //window.location = "/show_analysis/{{ md5 }}";
         }
         $('.progress-bar').animate({'width': n +'%'}).attr('aria-valuenow', n);    
     }).fail(function() {
         clearInterval(interval);
         displayerror(); // user defined
     });
}
</script>

<div class="container">
   <h2>Progress Bar With Label</h2>
   <div class="progress">
      <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%"></div>
   </div>
</div>

<form action="{{ url_for('view_results', md5=md5) }}">
    <input type="submit" class="btn" value="results" id="results" disabled/>
</form>

</p>

{% endblock %}
